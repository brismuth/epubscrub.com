{"version":3,"sources":["../node_modules/@ionic/core/dist/esm-es5 lazy /^/.//.*/.entry/.js$/ include: //.entry/.js$/ exclude: //.system/.entry/.js$/ groupOptions: {} namespace object","../node_modules/ionicons/dist/esm-es5 lazy /^/.//.*/.entry/.js$/ include: //.entry/.js$/ exclude: //.system/.entry/.js$/ groupOptions: {} namespace object","components/Menu.tsx","lib/Database.ts","pages/Upload.tsx","components/BookTile.tsx","lib/badwords.js","lib/Filters.ts","components/BookReader.tsx","pages/MyBooks.tsx","pages/Donate.tsx","App.tsx","serviceWorker.ts","index.tsx"],"names":["map","webpackAsyncContext","req","__webpack_require__","o","Promise","resolve","then","e","Error","code","ids","id","keys","Object","module","exports","appPages","title","url","iosIcon","cloudUploadOutline","mdIcon","cloudUploadSharp","libraryOutline","librarySharp","Menu","location","useLocation","contentId","type","appPage","index","key","autoHide","className","pathname","routerLink","routerDirection","lines","detail","slot","ios","md","Database","errorHandler","event","console","error","dbUpgrade","db","target","result","objectStoreNames","contains","createObjectStore","keyPath","bookMetaStore","createIndex","unique","startRequest","request","window","indexedDB","open","onerror","onupgradeneeded","saveGeneric","storeName","item","reject","onsuccess","transaction","objectStore","put","getByID","get","saveBook","book","a","bookFile","file","bookMeta","name","author","uploadDate","fileName","publishDate","coverImage","listBooks","bookList","getAll","list","getBook","bookID","saveLocation","bookLocation","bookLocationToSave","getLocation","Page","zip","JSZip","books","fileUpload","filelist","length","i","folder","loadAsync","Date","toLocaleString","undefined","push","metadataFiles","zipEntry","async","fileText","metadataFile","convert","xml2js","compact","metadata","package","getCoverImagePath","coverImageFilePath","pathPrefix","replace","files","message","coverImageManifestID","meta","forEach","metaInfo","_attributes","content","manifest","manifestItem","properties","includes","href","submit","onSubmit","preventDefault","onChange","BookTile","selectBook","class","onClick","src","alt","customReplacements","find","badwords","censorContainingWords","censorContainingSentence","censorContainingParagraph","rude","blasphemous","insensitive","strong","Filters","regexes","generateRegexes","exclude","regexStrings","removeWords","removeSentences","removeParagraphs","entries","words","word","wordSettings","regexSubstring","removeWordsRegex","join","removeSentencesRegex","removeParagraphsRegex","RegExp","filterPhrase","text","regex","startChar","endChar","replaceMessage","match","cleanText","exec","filterStart","lastIndexOf","filterEnd","indexOf","substring","estimate","extractMatch","collection","badWord","toLowerCase","matches","custom","paragraphs","sentences","workingText","conf","Array","from","matchAll","globalRegEx","m","repeat","matchText","trim","clean","badWordCount","cleanedPhrase","charAt","this","BookReader","props","state","rendition","setState","fileToArrayBuffer","bookBinary","applyFilters","filteredBinary","renderBook","fr","FileReader","onload","readAsArrayBuffer","epub","ePub","renderTo","themes","default","color","end","cfi","display","configureArrowKeyNav","configureLocationSaving","time","summary","filters","allFiles","subSummary","mergeFilterSummary","dir","JSON","stringify","generateAsync","timeEnd","collectionName","on","keyCode","which","prev","next","atStart","closeBook","isOpen","cssClass","size","prevPage","close","nextPage","React","Component","withIonLifeCycle","MyBooks","currentlyReading","collapse","App","path","component","Upload","exact","Donate","to","isLocalhost","Boolean","hostname","registerValidSW","swUrl","config","navigator","serviceWorker","register","registration","waiting","postMessage","onupdatefound","installingWorker","installing","onstatechange","controller","log","onUpdate","onSuccess","catch","ReactDOM","render","document","getElementById","URL","process","origin","addEventListener","fetch","headers","response","contentType","status","ready","unregister","reload","checkValidServiceWorker"],"mappings":"+IAAA,IAAIA,EAAM,CACT,kCAAmC,CAClC,IACA,IAED,iCAAkC,CACjC,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,8BAA+B,CAC9B,IACA,IAED,6BAA8B,CAC7B,IACA,IAED,iCAAkC,CACjC,IACA,IAED,gCAAiC,CAChC,IACA,IAED,8BAA+B,CAC9B,IACA,IAED,6BAA8B,CAC7B,IACA,IAED,8BAA+B,CAC9B,IACA,IAED,6BAA8B,CAC7B,IACA,IAED,4BAA6B,CAC5B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,8BAA+B,CAC9B,IACA,IAED,6BAA8B,CAC7B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,yBAA0B,CACzB,IACA,IAED,uBAAwB,CACvB,IACA,IAED,gCAAiC,CAChC,IACA,IAED,+BAAgC,CAC/B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,qBAAsB,CACrB,IACA,IAED,uCAAwC,CACvC,IACA,IAED,sCAAuC,CACtC,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,mCAAoC,CACnC,IACA,IAED,kCAAmC,CAClC,IACA,IAED,4BAA6B,CAC5B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,6BAA8B,CAC7B,IACA,IAED,4BAA6B,CAC5B,IACA,IAED,4BAA6B,CAC5B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,uBAAwB,CACvB,IACA,IAED,6BAA8B,CAC7B,IACA,IAED,4BAA6B,CAC5B,IACA,IAED,kCAAmC,CAClC,IACA,IAED,iCAAkC,CACjC,IACA,IAED,6BAA8B,CAC7B,IACA,IAED,4BAA6B,CAC5B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,iCAAkC,CACjC,IACA,IAED,gCAAiC,CAChC,IACA,IAED,+BAAg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","file":"static/js/main.df0c111e.chunk.js","sourcesContent":["var map = {\n\t\"./ion-action-sheet-ios.entry.js\": [\n\t\t192,\n\t\t31\n\t],\n\t\"./ion-action-sheet-md.entry.js\": [\n\t\t193,\n\t\t32\n\t],\n\t\"./ion-alert-ios.entry.js\": [\n\t\t194,\n\t\t33\n\t],\n\t\"./ion-alert-md.entry.js\": [\n\t\t195,\n\t\t34\n\t],\n\t\"./ion-app_8-ios.entry.js\": [\n\t\t196,\n\t\t13\n\t],\n\t\"./ion-app_8-md.entry.js\": [\n\t\t197,\n\t\t14\n\t],\n\t\"./ion-avatar_3-ios.entry.js\": [\n\t\t198,\n\t\t35\n\t],\n\t\"./ion-avatar_3-md.entry.js\": [\n\t\t199,\n\t\t36\n\t],\n\t\"./ion-back-button-ios.entry.js\": [\n\t\t200,\n\t\t37\n\t],\n\t\"./ion-back-button-md.entry.js\": [\n\t\t201,\n\t\t38\n\t],\n\t\"./ion-backdrop-ios.entry.js\": [\n\t\t202,\n\t\t79\n\t],\n\t\"./ion-backdrop-md.entry.js\": [\n\t\t203,\n\t\t80\n\t],\n\t\"./ion-button_2-ios.entry.js\": [\n\t\t204,\n\t\t39\n\t],\n\t\"./ion-button_2-md.entry.js\": [\n\t\t205,\n\t\t40\n\t],\n\t\"./ion-card_5-ios.entry.js\": [\n\t\t206,\n\t\t41\n\t],\n\t\"./ion-card_5-md.entry.js\": [\n\t\t207,\n\t\t42\n\t],\n\t\"./ion-checkbox-ios.entry.js\": [\n\t\t208,\n\t\t43\n\t],\n\t\"./ion-checkbox-md.entry.js\": [\n\t\t209,\n\t\t44\n\t],\n\t\"./ion-chip-ios.entry.js\": [\n\t\t210,\n\t\t45\n\t],\n\t\"./ion-chip-md.entry.js\": [\n\t\t211,\n\t\t46\n\t],\n\t\"./ion-col_3.entry.js\": [\n\t\t212,\n\t\t81\n\t],\n\t\"./ion-datetime_3-ios.entry.js\": [\n\t\t213,\n\t\t19\n\t],\n\t\"./ion-datetime_3-md.entry.js\": [\n\t\t214,\n\t\t20\n\t],\n\t\"./ion-fab_3-ios.entry.js\": [\n\t\t215,\n\t\t47\n\t],\n\t\"./ion-fab_3-md.entry.js\": [\n\t\t216,\n\t\t48\n\t],\n\t\"./ion-img.entry.js\": [\n\t\t217,\n\t\t82\n\t],\n\t\"./ion-infinite-scroll_2-ios.entry.js\": [\n\t\t218,\n\t\t83\n\t],\n\t\"./ion-infinite-scroll_2-md.entry.js\": [\n\t\t219,\n\t\t84\n\t],\n\t\"./ion-input-ios.entry.js\": [\n\t\t220,\n\t\t49\n\t],\n\t\"./ion-input-md.entry.js\": [\n\t\t221,\n\t\t50\n\t],\n\t\"./ion-item-option_3-ios.entry.js\": [\n\t\t222,\n\t\t51\n\t],\n\t\"./ion-item-option_3-md.entry.js\": [\n\t\t223,\n\t\t52\n\t],\n\t\"./ion-item_8-ios.entry.js\": [\n\t\t224,\n\t\t53\n\t],\n\t\"./ion-item_8-md.entry.js\": [\n\t\t225,\n\t\t54\n\t],\n\t\"./ion-loading-ios.entry.js\": [\n\t\t226,\n\t\t55\n\t],\n\t\"./ion-loading-md.entry.js\": [\n\t\t227,\n\t\t56\n\t],\n\t\"./ion-menu_3-ios.entry.js\": [\n\t\t228,\n\t\t57\n\t],\n\t\"./ion-menu_3-md.entry.js\": [\n\t\t229,\n\t\t58\n\t],\n\t\"./ion-modal-ios.entry.js\": [\n\t\t230,\n\t\t15\n\t],\n\t\"./ion-modal-md.entry.js\": [\n\t\t231,\n\t\t16\n\t],\n\t\"./ion-nav_2.entry.js\": [\n\t\t232,\n\t\t27\n\t],\n\t\"./ion-popover-ios.entry.js\": [\n\t\t233,\n\t\t17\n\t],\n\t\"./ion-popover-md.entry.js\": [\n\t\t234,\n\t\t18\n\t],\n\t\"./ion-progress-bar-ios.entry.js\": [\n\t\t235,\n\t\t59\n\t],\n\t\"./ion-progress-bar-md.entry.js\": [\n\t\t236,\n\t\t60\n\t],\n\t\"./ion-radio_2-ios.entry.js\": [\n\t\t237,\n\t\t61\n\t],\n\t\"./ion-radio_2-md.entry.js\": [\n\t\t238,\n\t\t62\n\t],\n\t\"./ion-range-ios.entry.js\": [\n\t\t239,\n\t\t63\n\t],\n\t\"./ion-range-md.entry.js\": [\n\t\t240,\n\t\t64\n\t],\n\t\"./ion-refresher_2-ios.entry.js\": [\n\t\t241,\n\t\t21\n\t],\n\t\"./ion-refresher_2-md.entry.js\": [\n\t\t242,\n\t\t22\n\t],\n\t\"./ion-reorder_2-ios.entry.js\": [\n\t\t243,\n\t\t29\n\t],\n\t\"./ion-reorder_2-md.entry.js\": [\n\t\t244,\n\t\t30\n\t],\n\t\"./ion-ripple-effect.entry.js\": [\n\t\t245,\n\t\t85\n\t],\n\t\"./ion-route_4.entry.js\": [\n\t\t246,\n\t\t65\n\t],\n\t\"./ion-searchbar-ios.entry.js\": [\n\t\t247,\n\t\t66\n\t],\n\t\"./ion-searchbar-md.entry.js\": [\n\t\t248,\n\t\t67\n\t],\n\t\"./ion-segment_2-ios.entry.js\": [\n\t\t249,\n\t\t68\n\t],\n\t\"./ion-segment_2-md.entry.js\": [\n\t\t250,\n\t\t69\n\t],\n\t\"./ion-select_3-ios.entry.js\": [\n\t\t251,\n\t\t70\n\t],\n\t\"./ion-select_3-md.entry.js\": [\n\t\t252,\n\t\t71\n\t],\n\t\"./ion-slide_2-ios.entry.js\": [\n\t\t253,\n\t\t86\n\t],\n\t\"./ion-slide_2-md.entry.js\": [\n\t\t254,\n\t\t87\n\t],\n\t\"./ion-spinner.entry.js\": [\n\t\t255,\n\t\t25\n\t],\n\t\"./ion-split-pane-ios.entry.js\": [\n\t\t256,\n\t\t88\n\t],\n\t\"./ion-split-pane-md.entry.js\": [\n\t\t257,\n\t\t89\n\t],\n\t\"./ion-tab-bar_2-ios.entry.js\": [\n\t\t258,\n\t\t72\n\t],\n\t\"./ion-tab-bar_2-md.entry.js\": [\n\t\t259,\n\t\t73\n\t],\n\t\"./ion-tab_2.entry.js\": [\n\t\t260,\n\t\t28\n\t],\n\t\"./ion-text.entry.js\": [\n\t\t261,\n\t\t74\n\t],\n\t\"./ion-textarea-ios.entry.js\": [\n\t\t262,\n\t\t75\n\t],\n\t\"./ion-textarea-md.entry.js\": [\n\t\t263,\n\t\t76\n\t],\n\t\"./ion-toast-ios.entry.js\": [\n\t\t264,\n\t\t77\n\t],\n\t\"./ion-toast-md.entry.js\": [\n\t\t265,\n\t\t78\n\t],\n\t\"./ion-toggle-ios.entry.js\": [\n\t\t266,\n\t\t23\n\t],\n\t\"./ion-toggle-md.entry.js\": [\n\t\t267,\n\t\t24\n\t],\n\t\"./ion-virtual-scroll.entry.js\": [\n\t\t268,\n\t\t90\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 114;\nmodule.exports = webpackAsyncContext;","var map = {\n\t\"./ion-icon.entry.js\": [\n\t\t272,\n\t\t93\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 116;\nmodule.exports = webpackAsyncContext;","import {\n  IonContent,\n  IonIcon,\n  IonItem,\n  IonLabel,\n  IonList,\n  IonListHeader,\n  IonMenu,\n  IonMenuToggle,\n  IonNote,\n} from '@ionic/react';\n\nimport React from 'react';\nimport { useLocation } from 'react-router-dom';\nimport { cloudUploadOutline, cloudUploadSharp, heartOutline, heartSharp, libraryOutline, librarySharp } from 'ionicons/icons';\nimport './Menu.css';\n\ninterface AppPage {\n  url: string;\n  iosIcon: string;\n  mdIcon: string;\n  title: string;\n}\n\nconst appPages: AppPage[] = [\n  {\n    title: 'Upload an eBook',\n    url: '/page/Upload',\n    iosIcon: cloudUploadOutline,\n    mdIcon: cloudUploadSharp\n  },\n  {\n    title: 'My Books',\n    url: '/page/MyBooks',\n    iosIcon: libraryOutline,\n    mdIcon: librarySharp\n  },\n  // {\n  //   title: 'Donate',\n  //   url: '/page/Donate',\n  //   iosIcon: heartOutline,\n  //   mdIcon: heartSharp\n  // }\n];\n\nconst Menu: React.FC = () => {\n  const location = useLocation();\n\n  return (\n    <IonMenu contentId=\"main\" type=\"overlay\">\n      <IonContent>\n        <IonList id=\"inbox-list\">\n          <IonListHeader>ePubScrub</IonListHeader>\n          <IonNote>Read books however the <i>BLEEP</i> you want</IonNote>\n          {appPages.map((appPage, index) => {\n            return (\n              <IonMenuToggle key={index} autoHide={false}>\n                <IonItem className={location.pathname === appPage.url ? 'selected' : ''} routerLink={appPage.url} routerDirection=\"none\" lines=\"none\" detail={false}>\n                  <IonIcon slot=\"start\" ios={appPage.iosIcon} md={appPage.mdIcon} />\n                  <IonLabel>{appPage.title}</IonLabel>\n                </IonItem>\n              </IonMenuToggle>\n            );\n          })}\n        </IonList>\n      </IonContent>\n    </IonMenu>\n  );\n};\n\nexport default Menu;\n","\nexport interface Book {\n  id: string,\n  name: string,\n  author: string,\n  uploadDate: Date,\n  fileName: string,\n  publishDate: Date,\n  coverImage: string | undefined\n}\n\nexport interface FullBook {\n  id: string,\n  name: string,\n  author: string,\n  uploadDate: Date,\n  fileName: string,\n  publishDate: Date,\n  coverImage: string | undefined,\n  file: File\n}\n\nexport interface BookFile {\n  id: string,\n  file: File\n}\n\n// see epub.js for full location definition\nexport interface BookLocation {\n  end: {\n    cfi: string,\n    percentage: number\n  },\n  start: {\n    cfi: string,\n    percentage: number\n  },\n  atStart: boolean | undefined\n}\n\nexport interface BookLocationDB {\n  bookID: string,\n  bookLocation: BookLocation\n}\n\nexport class Database {\n  errorHandler = (event: any) => {\n    console.error(\"Error using IndexedDB\");\n  };\n\n  dbUpgrade = (event: any) => {\n    let db = event.target.result;\n\n    if (!db.objectStoreNames.contains(\"bookFiles\")) {\n      db.createObjectStore(\"bookFiles\", { keyPath: \"id\" });\n    }\n\n    if(!db.objectStoreNames.contains(\"bookMetaData\")) {\n      let bookMetaStore = db.createObjectStore(\"bookMetaData\", { keyPath: \"id\" });\n      bookMetaStore.createIndex(\"name\", \"name\", { unique: false });\n      bookMetaStore.createIndex(\"author\", \"author\", { unique: false });\n      bookMetaStore.createIndex(\"uploadDate\", \"uploadDate\", { unique: false });\n      bookMetaStore.createIndex(\"publishDate\", \"publishDate\", { unique: false });\n    }\n\n    if (!db.objectStoreNames.contains(\"bookLocations\")) {\n      db.createObjectStore(\"bookLocations\", { keyPath: \"bookID\" });\n    }\n  };\n\n  startRequest = () => {\n    let request = window.indexedDB.open(\"ebook-cleaner\", 3);\n    request.onerror = this.errorHandler;\n    request.onupgradeneeded = this.dbUpgrade;\n\n    return request;\n  }\n\n  private saveGeneric = (storeName: string, item: any) => {\n    return new Promise((resolve, reject) => {\n      let request = this.startRequest();\n      request.onsuccess = (event: any) => {\n        let db = event.target.result;\n        let store = db.transaction(storeName, \"readwrite\").objectStore(storeName);\n        let result = store.put(item);\n        result.onsuccess = () => {\n          resolve();\n        };\n        result.onerror = (error: any) => {\n          console.error(error);\n          reject(error);\n        };\n      }\n    });\n  }\n\n  private getByID = (storeName: string, id: string): Promise<any> => {\n    return new Promise((resolve, reject) => {\n      let request = this.startRequest();\n      request.onsuccess = (event: any) => {\n        let db = event.target.result;\n        let store = db.transaction(storeName, \"readwrite\").objectStore(storeName);\n        let item = store.get(id);\n        item.onsuccess = () => {\n          resolve(item.result);\n        };\n        item.onerror = (error: any) => {\n          console.error(error);\n          reject(error);\n        };\n      };\n    });\n  }\n\n  public saveBook = async (book: FullBook) => {\n    let bookFile: BookFile = {\n      id: book.id,\n      file: book.file\n    };\n\n    await this.saveGeneric('bookFiles', bookFile);\n\n    let bookMeta: Book = {\n      id: book.id,\n      name: book.name,\n      author: book.author,\n      uploadDate: book.uploadDate,\n      fileName: book.fileName,\n      publishDate: book.publishDate,\n      coverImage: book.coverImage\n    };\n    await this.saveGeneric('bookMetaData', bookMeta);\n  }\n\n  public listBooks = (): Promise<Array<Book>> => {\n    return new Promise((resolve, reject) => {\n      let request = this.startRequest();\n      request.onsuccess = (event: any) => {\n        let db = event.target.result;\n        let bookStore = db.transaction(\"bookMetaData\", \"readwrite\").objectStore(\"bookMetaData\");\n        let bookList = bookStore.getAll();\n        bookList.onsuccess = () => {\n          let list = bookList.result;\n          resolve(list);\n        };\n        bookList.onerror = (error: any) => {\n          console.error(error);\n          reject(error);\n        };\n      };\n    });\n  }\n\n  public getBook = (bookID: string): Promise<BookFile> => {\n    return this.getByID('bookFiles', bookID);\n  }\n\n  public saveLocation = async (bookID: string, bookLocation: BookLocation) => {\n    let bookLocationToSave = {\n      bookID,\n      bookLocation\n    };\n\n    await this.saveGeneric('bookLocations', bookLocationToSave);\n  }\n\n  public getLocation = (bookID: string): Promise<BookLocationDB | null> => {\n    return this.getByID('bookLocations', bookID);\n  }\n}","import { IonButton, IonButtons, IonContent, IonHeader, IonMenuButton, IonPage, IonTitle, IonToolbar } from '@ionic/react';\nimport React from 'react';\nimport JSZip from 'jszip';\nimport convert from 'xml-js';\nimport { Database, FullBook } from '../lib/Database';\nimport './Upload.css';\n\nconst Page: React.FC = () => {\n  let zip = new JSZip();\n  let db = new Database();\n  let books: Array<FullBook> = [];\n\n  const fileUpload = async (filelist: FileList | null) => {\n    if (!filelist) {\n      return;\n    }\n\n    books.length = 0;\n    for (var i = 0; i < filelist.length; i++) {\n      let file = filelist[i];\n      let folder;\n      try {\n        folder = await zip.loadAsync(file);\n        let book: FullBook = {\n          id: file.name + ' - ' + new Date().toLocaleString(),\n          name: file.name,\n          author: 'Unknown',\n          uploadDate: new Date(),\n          fileName: file.name,\n          publishDate: new Date(),\n          coverImage: undefined,\n          file: file\n        };\n        books.push(book);\n\n        let metadataFiles = await zip.file(/content.opf/);\n        for (const zipEntry of metadataFiles) {\n          if (zipEntry) {\n            let fileText = await zipEntry.async('text');\n\n            let metadataFile: any = convert.xml2js(fileText, {compact: true});\n            let metadata = metadataFile.package.metadata;\n            book.author = metadata['dc:creator']['_text'];\n            book.name = metadata['dc:title']['_text'];;\n            book.publishDate = metadata['dc:date']['_text'];\n\n            let coverImageFilePath = await getCoverImagePath(metadataFile);\n            if (coverImageFilePath) {\n              let pathPrefix = zipEntry.name.replace('content.opf', '');\n              book.coverImage = await folder.files[pathPrefix + coverImageFilePath].async('base64');\n            }\n          }\n        }\n      } catch (e) {\n        console.error(\"Error reading \" + file.name + \": \" + e.message);\n        return;\n      }\n    }\n  }\n\n  const getCoverImagePath = (metadataFile: any) => {\n    let coverImageManifestID = '';\n    let metadata = metadataFile.package.metadata;\n    if (metadata.meta) {\n      metadata.meta.forEach((metaInfo: any) => {\n        if (metaInfo._attributes.name === 'cover') {\n          coverImageManifestID = metaInfo._attributes.content;\n        }\n      });\n    }\n\n    let coverImageFilePath = '';\n    let manifest = metadataFile.package.manifest.item;\n    manifest.forEach((manifestItem: any) => {\n      if (manifestItem._attributes.id === coverImageManifestID\n        || manifestItem._attributes.properties === 'cover-image'\n        || (coverImageFilePath === undefined && manifestItem._attributes.id.includes('cover')) // best guess\n        ) {\n        coverImageFilePath = manifestItem._attributes.href;\n      }\n    });\n\n    return coverImageFilePath;\n  }\n\n  const submit = async () =>  {\n    if (!books || books.length === 0) {\n      return;\n    }\n\n    for (var i = 0; i < books.length; i++) {\n      let book = books[i];\n      await db.saveBook(book);\n    }\n    window.location.href = '/page/MyBooks'\n  };\n\n  const name = 'Upload an eBook';\n\n  return (\n    <IonPage>\n      <IonHeader>\n        <IonToolbar>\n          <IonButtons slot=\"start\">\n            <IonMenuButton />\n          </IonButtons>\n          <IonTitle>{name}</IonTitle>\n        </IonToolbar>\n      </IonHeader>\n\n      <IonContent>\n        <form id='book-upload-form' onSubmit={(e) => { e.preventDefault(); submit();}}>\n          Select ePub:\n          <input type=\"file\" name=\"file\" onChange={(e) => fileUpload(e.target.files)}/>\n          <br/>\n          <br/>\n          <IonButton type=\"submit\">\n            submit\n          </IonButton>\n        </form>\n      </IonContent>\n    </IonPage>\n  );\n};\n\nexport default Page;\n","import { IonCard, IonCardHeader, IonCardSubtitle, IonCardTitle, IonCardContent } from '@ionic/react';\nimport React from 'react';\nimport { Book } from '../lib/Database';\nimport './BookTile.css';\n\ninterface ContainerProps {\n  key: string;\n  book: Book;\n  selectBook: (book: Book) => void;\n}\n\nconst BookTile: React.FC<ContainerProps> = ({ book, selectBook  }) => {\n  return (\n    <IonCard class='book-tile' onClick={() => selectBook(book)}>\n      <IonCardContent>\n        <img src={ 'data:image/png;base64, ' + book.coverImage } alt=\"Red dot\" />\n      </IonCardContent>\n      <IonCardHeader>\n        <IonCardTitle>{book.name}</IonCardTitle>\n        <IonCardSubtitle>{book.author}</IonCardSubtitle>\n      </IonCardHeader>\n    </IonCard>\n  );\n};\n\nexport default BookTile;\n","export let customReplacements = [\n\t{\tfind: /\\bthe fuck\\b/gi,\t\t\t\treplace: 'the heck' },\n\t{\tfind: /\\bfucker/gi,\t\t\t\t\treplace: 'guy' },\n\t{\tfind: /\\bfuckin/gi,\t\t\t\t\treplace: 'spacin' },\n\t{\tfind: /\\bfucked\\b/gi,\t\t\t\treplace: 'screwed' },\n\t{\tfind: /\\bfuck th/gi,\t\t\t\treplace: 'screw th' },\n\t{\tfind: /\\bMotherfucker/gi,\t\t\treplace: 'jerk' },\n\t{\tfind: /fuck\\b/gi,\t\t\t\t\treplace: 'space' },\n\t{\tfind: /fuck/gi,\t\t\t\t\t\treplace: 'storm' },\n\t{\tfind: /\\bhell\\b/gi,\t\t\t\t\treplace: 'heck' },\n\t{\tfind: /\\bsonofabitch\\b/gi,\t\t\treplace: 'son-of-a-gun' },\n\t{\tfind: /\\bbitch\\b/gi,\t\t\t\treplace: 'dog' },\n\t{\tfind: /\\basshole/gi,\t\t\t\treplace: 'jerk' },\n\t{\tfind: /\\bass\\b/gi,\t\t\t\t\treplace: 'butt' },\n\t{\tfind: /\\basses\\b/gi,\t\t\t\treplace: 'butts' },\n\t{\tfind: /pissed/gi,\t\t\t\t\treplace: 'peed' },\n\t{\tfind: /piss/gi,\t\t\t\t\t\treplace: 'pee' },\n\t{\tfind: /jesus/gi,\t\t\t\t\treplace: 'geez' },\n\t{\tfind: /christ/gi,\t\t\t\t\treplace: 'geez' },\n\t{\tfind: /shitty\\b/gi,\t\t\t\t\treplace: 'bad' },\n\t{\tfind: /shittier\\b/gi,\t\t\t\treplace: 'worse' },\n\t{\tfind: /shittiest\\b/gi,\t\t\t\treplace: 'worst' },\n\t{\tfind: /shit\\b/gi,\t\t\t\t\treplace: 'crap' },\n\t{\tfind: /shitting\\b/gi,\t\t\t\treplace: 'crapping' },\n\t{\tfind: /\\bbastard([s]*)\\b/gi,\t\treplace: 'illegitimate son$1' },\n\t{\tfind: /\\bwhorehouse\\b/gi,\t\t\treplace: 'brothel' },\n\t{\tfind: /\\bwhor([ei])/gi,\t\t\t\treplace: 'prostitut$1' },\n\t{\tfind: /\\bgoddamn/gi,\t\t\t\treplace: 'darn' },\n\t{\tfind: /\\bdamn\\b/gi,\t\t\t\t\treplace: 'darn' },\n];\n\nexport let badwords = {\n\t'sexually-explicit': {\n\t\t\"anus\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"anal\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"ballbag\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t// \"balls\": { // doesn't work well, too many non-explicit uses\n\t\t// \tcensorContainingWords: false,\n\t\t// \tcensorContainingSentence: false,\n\t\t// \tcensorContainingParagraph: false,\n\t\t// },\n\t\t\"ballsack\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"beastial\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"beastiality\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"blow job\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"blowjob\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"boner\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"boning\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"boob\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"breasts\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"ass\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"butt\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"buttplug\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"butthole\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"clit\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"clitoris\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"cock\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"cock-sucker\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"cockface\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"cockhead\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"cockmunch\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"cockmuncher\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"cocksuck\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"cocksucked\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"cocksucker\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"cocksucking\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"cum\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"cummer\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"cumming\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"cumshot\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"cunilingus\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"cunillingus\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"cunnilingus\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"cunt\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"cuntlick\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"cuntlicker\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"cuntlicking\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"dick\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"dickhead\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"dildo\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"ejaculate\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"ejaculation\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"ejaculating\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"fellatio\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"gangbang\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"hand job\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"horniest\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"horny\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"jack-off\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"jackoff\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"jerk-off\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"jizz\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"labia\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"lust\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"lusting\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"masochist\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"masturbate\": {\n\t\t\tcensorContainingWords: true,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"orgasm\": {\n\t\t\tcensorContainingWords: true,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"pecker\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"penis\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"porn\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"porno\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"pornography\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"pornos\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"pube\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"pubic\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"pussies\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"pussy\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"rectum\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"rimming\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"sadist\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"scrotum\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"semen\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"sex\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"shagging\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"shemale\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"skank\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"slut\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"sluts\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"testicle\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"tit\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"titties\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"twat\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"twathead\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"vagina\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"vulva\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"wank\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"whacking off\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"whore\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"xrated\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t},\n\t\t\"xxx\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: true,\n\t\t\tcensorContainingParagraph: true,\n\t\t}\n\t},\n\trude: {\n\t\t\"arse\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"bastard\": {\n\t\t\tcensorContainingWords: true,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"bellend\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"bloody\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"butt\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"crap\": {\n\t\t\tcensorContainingWords: true,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"piss\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"pissed\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"pisser\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"pissers\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"pisses\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"pissflaps\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"pissin\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"pissing\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"pissoff\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"poop\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"turd\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t}\n\t},\n\tblasphemous: {\n\t\t\"christ\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"god\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"god-dam\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"god-damned\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"goddamn\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"goddamned\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"jesus\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"hell\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t},\n\tinsensitive: {\n\t\t\"nazi\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"nigga\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"niggah\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"niggas\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"niggaz\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"nigger\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"niggers\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"retard\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t},\n\tstrong: {\n\t\t\"ass\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"asses\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"asshole\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"assholes\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"bitch\": {\n\t\t\tcensorContainingWords: true,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"butthole\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"damn\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"dick\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"dickhead\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"f u c k\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"f u c k e r\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"fag\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"faggot\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"fags\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"fuck\": {\n\t\t\tcensorContainingWords: true,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"shag\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"shit\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"shithead\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"shits\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"shitted\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"shitter\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"shitters\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"shitting\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"shittings\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"shitty\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t\t\"son-of-a-bitch\": {\n\t\t\tcensorContainingWords: false,\n\t\t\tcensorContainingSentence: false,\n\t\t\tcensorContainingParagraph: false,\n\t\t},\n\t}\n}","import {badwords, customReplacements} from './badwords';\n\n\nexport class Filters {\n  private regexes: {\n    [key: string]: RegExp | null\n  };\n  constructor() {\n    this.regexes = this.generateRegexes({\n      'bastard': false,\n      'bloody': false,\n      'butt': false,\n      'crap': false,\n      'god': false,\n      'heck': false,\n      'hell': false,\n      'poop': false,\n      'sex': false,\n      'turd': false,\n    });\n  }\n\n  private generateRegexes = (exclude: any) => {\n    type regexStringsType = {\n      [key: string]: Array<string>\n    };\n    let notPunctuation = `[^.!?\"<>]`;\n    let regexStrings: regexStringsType = {\n      removeWords: [],\n      removeSentences: [], // punctuation to punctuation\n      removeParagraphs: [] //  tag to tag - > to <\n    }\n\n    Object.entries(badwords).forEach(([category, words]) => {\n      Object.entries(words).forEach(([word, wordSettings]) => {\n        if (word in exclude) return;\n\n        let regexSubstring = word + `s?`; // also match \"s\" on end of bad words\n\n        // filter out entire hyphen-letter parent word\n        if (wordSettings.censorContainingWords) {\n          regexSubstring = `[a-z\\\\-]*${regexSubstring}[a-z\\\\-]*`;\n        }\n\n        // word boundaries\n        regexSubstring = `\\\\b${regexSubstring}\\\\b`;\n\n        // we only need to do the most wide-reaching removal\n        if (wordSettings.censorContainingParagraph) {\n          regexStrings.removeParagraphs.push(regexSubstring);\n        } else if (wordSettings.censorContainingSentence) {\n          regexStrings.removeSentences.push(regexSubstring);\n        } else {\n          regexStrings.removeWords.push(regexSubstring);\n        }\n      });\n    });\n    let removeWordsRegex = regexStrings.removeWords.length > 0 ? `(${regexStrings.removeWords.join('|')})` : '';\n    let removeSentencesRegex = regexStrings.removeSentences.length > 0 ? regexStrings.removeSentences.join('|') : '';\n    let removeParagraphsRegex = regexStrings.removeParagraphs.length > 0 ? regexStrings.removeParagraphs.join('|') : '';\n\n    return {\n      removeWords: removeWordsRegex ? new RegExp(removeWordsRegex, 'gi') : null,\n      removeSentences: removeSentencesRegex ? new RegExp(removeSentencesRegex, 'i') : null,\n      removeParagraphs: removeParagraphsRegex ? new RegExp(removeParagraphsRegex, 'i') : null,\n    };\n  }\n\n  private filterPhrase = (text: string, regex: RegExp, startChar: string, endChar: string, replaceMessage: string) => {\n    let cleanText = text;\n\n    let match;\n    do {\n      match = regex.exec(cleanText);\n      if (match) {\n        let filterStart = cleanText.lastIndexOf(startChar, match.index) + 1;\n        let filterEnd = cleanText.indexOf(endChar, match.index + match[0].length);\n        cleanText = cleanText.substring(0, filterStart) + replaceMessage + cleanText.substring(filterEnd);\n      }\n    } while (match);\n    return cleanText;\n  }\n\n  public estimate = (text: string) => {\n    const extractMatch = (match: RegExpMatchArray, collection: any) => {\n      const badWord = match[0].toLowerCase();\n      collection[badWord] = collection[badWord] || [];\n      collection[badWord].push({\n        index: match.index\n      });\n    };\n\n    let matches = {\n      custom: {},\n      paragraphs: {},\n      sentences: {},\n      words: {}\n    };\n\n    let workingText = text; // we remove words as we match them to prevent duplication\n\n    customReplacements.forEach((conf) => {\n      Array.from(workingText.matchAll(conf.find)).forEach((match) => { extractMatch(match, matches.custom) })\n      workingText = workingText.replace(conf.find, conf.replace);\n    });\n\n    if (this.regexes.removeParagraphs) {\n      let globalRegEx = new RegExp(this.regexes.removeParagraphs, 'gi');\n      Array.from(workingText.matchAll(globalRegEx)).forEach((match) => { extractMatch(match, matches.paragraphs) })\n      workingText = workingText.replace(globalRegEx, m => {return '*'.repeat(m.length)});\n    }\n    if (this.regexes.removeSentences) {\n      Array.from(workingText.matchAll(this.regexes.removeSentences)).forEach((match) => { extractMatch(match, matches.sentences) })\n      workingText = workingText.replace(this.regexes.removeSentences, m => {return '*'.repeat(m.length)});\n    }\n    if (this.regexes.removeWords) {\n      Array.from(workingText.matchAll(this.regexes.removeWords)).forEach((match) => { extractMatch(match, matches.words) })\n      workingText = workingText.replace(this.regexes.removeWords, m => {return '*'.repeat(m.length)});\n    }\n\n    Object.entries(matches).forEach(([collectionName, words]) => {\n      Object.entries(words).forEach(([word, matches]) => {\n        //@ts-ignore\n        matches.forEach((match) => {\n          //@ts-ignore\n          match.matchText = workingText.substring(match.index - 150, match.index + 150);\n          match.matchText = match.matchText.replace(/<[^>]+>/gi, '');\n          match.matchText = match.matchText.replace(/^[^>]+>/gi, '');\n          match.matchText = match.matchText.replace(/<[^<]+>/gi, '');\n          match.matchText = match.matchText.replace(/<[^<]+$/gi, '');\n          match.matchText = `...${match.matchText.trim()}...`;\n        });\n      });\n    });\n\n    return matches;\n  };\n\n  public clean = (text: string) => {\n    let badWordCount = 0;\n\n    let cleanText = text;\n\n    // custom replacements\n    customReplacements.forEach((conf) => {\n      cleanText = cleanText.replace(conf.find, conf.replace);\n    });\n\n    // paragraphs\n    if (this.regexes.removeParagraphs) {\n      cleanText = this.filterPhrase(cleanText, this.regexes.removeParagraphs, '>', '<', '<i>[paragraph removed by filters]</i>');\n    }\n\n    // sentences\n    if (this.regexes.removeSentences) {\n      // to-do - this is actually just doing paragraph removal - need to handle regex or finding closest of <>.!?\"\n      cleanText = this.filterPhrase(cleanText, this.regexes.removeSentences, '>', '<', '<i>[sentence removed by filters]</i>');\n    }\n\n    // words\n    if (this.regexes.removeWords) {\n      cleanText = cleanText.replace(this.regexes.removeWords, m => {\n        badWordCount++;\n        let cleanedPhrase = '';\n        for (var i = 0; i < m.length; i++) {\n          cleanedPhrase += m.charAt(i) === ' ' ? ' ' : '*';\n        }\n        return cleanedPhrase;\n      });\n    }\n\n    return cleanText;\n  }\n}\n","import { IonModal, IonButton, IonContent, IonFooter, withIonLifeCycle } from '@ionic/react';\nimport React from 'react';\nimport ePub from 'epubjs';\nimport JSZip from 'jszip';\nimport './BookReader.css';\nimport { Database, Book, FullBook, BookLocation } from '../lib/Database';\nimport { Filters } from '../lib/Filters';\n\ninterface props {\n  bookMeta: Book,\n  closeBook: () => void\n};\n\ninterface state {\n  book: Book | FullBook,\n  rendition: ePub.Rendition | null\n};\n\nclass BookReader extends React.Component<props, state> {\n  constructor(props: any) {\n    super(props);\n    this.state = {\n      book: props.bookMeta,\n      rendition: null\n    };\n  }\n\n  async componentDidMount() {\n    let db = new Database();\n    let bookFile = await db.getBook(this.state.book.id);\n    let book = {\n      ...this.state.book,\n      ...bookFile\n    };\n\n    this.setState({\n      book\n    });\n\n    let location = await db.getLocation(this.state.book.id);\n    let bookBinary = await this.fileToArrayBuffer(book.file);\n\n    let filteredBinary = await this.applyFilters(bookBinary);\n    this.renderBook(filteredBinary, location ? location.bookLocation : null)\n  }\n\n  // https://gist.github.com/hanayashiki/8dac237671343e7f0b15de617b0051bd\n  async fileToArrayBuffer(file: File): Promise<ArrayBuffer> {\n    return new Promise((resolve) => {\n      let fr = new FileReader();\n      fr.onload = () => {\n        //@ts-ignore\n        resolve(fr.result);\n      };\n      fr.readAsArrayBuffer(file);\n    })\n  }\n\n  async renderBook(bookBinary: ArrayBuffer, location: BookLocation | null) {\n    try {\n      let epub = ePub();\n      epub.open(bookBinary, \"binary\");\n\n      let rendition = epub.renderTo(\"epub-renderer\");\n      rendition.themes.default({\n        'body *': {\n          color: '#CCC !important'\n        },\n        'p': {\n          'font-size': '15px !important'\n        }\n      });\n\n      if (location\n        && location.end\n        && location.end.cfi) {\n        rendition.display(location.end.cfi);\n      } else {\n        rendition.display();\n      }\n\n      this.setState({\n        rendition\n      });\n\n      this.configureArrowKeyNav(rendition);\n      this.configureLocationSaving(rendition);\n    } catch (error) {\n      console.error(error)\n    }\n  }\n\n  async applyFilters(bookBinary: ArrayBuffer) {\n    console.time('applying filters');\n    let summary = {};\n    let filters = new Filters();\n\n    let zip = new JSZip();\n    await zip.loadAsync(bookBinary);\n    let allFiles = await zip.file(/[\\s\\S]*/);\n    for (const zipEntry of allFiles) {\n      if (zipEntry) {\n        let fileText = await zipEntry.async('text');\n\n        if (fileText.includes('<?xml')) {\n          let cleanText = filters.clean(fileText);\n          let subSummary = filters.estimate(fileText);\n          this.mergeFilterSummary(summary, subSummary);\n\n          zip.file(zipEntry.name, cleanText);\n        }\n      }\n    }\n\n    console.dir(JSON.stringify(summary));\n    let filteredBinary = await zip.generateAsync({type:'arraybuffer'});\n    console.timeEnd('applying filters');\n    return filteredBinary;\n  }\n\n  // @ts-ignore\n  mergeFilterSummary(summary, subSummary) {\n    // @ts-ignore\n    Object.entries(subSummary).forEach(([collectionName, words]) => {\n      // @ts-ignore\n      Object.entries(words).forEach(([word, matches]) => {\n        //@ts-ignore\n        summary[collectionName] = summary[collectionName] || {};\n        //@ts-ignore\n        let collection = summary[collectionName];\n        collection[word] = collection[word] || [];\n        collection[word] = [\n          ...collection[word],\n          //@ts-ignore\n          ...matches\n        ]\n      });\n    });\n  }\n\n  configureArrowKeyNav(rendition: ePub.Rendition) {\n    var keyListener = (e: KeyboardEvent) => {\n      // Left Key\n      if ((e.keyCode || e.which) === 37) {\n        rendition.prev();\n      }\n      // Right Key\n      if ((e.keyCode || e.which) === 39) {\n        rendition.next();\n      }\n    };\n\n    rendition.on(\"keyup\", keyListener);\n  }\n\n  configureLocationSaving(rendition: ePub.Rendition) {\n    let db = new Database();\n    rendition.on(\"relocated\", (location: BookLocation) => {\n      if (!location.atStart) {\n        db.saveLocation(this.state.book.id, location);\n      }\n    });\n  }\n\n  async close() {\n    this.props.closeBook();\n  }\n\n  nextPage() {\n    if (this.state.rendition) {\n      this.state.rendition.next();\n    }\n  }\n\n  prevPage() {\n    if (this.state.rendition) {\n      this.state.rendition.prev();\n    }\n  }\n\n  render() {\n    return (\n      <IonContent>\n        <IonModal isOpen cssClass='epub-renderer-modal'>\n          <div id='render-wrapper'>\n            <div id='epub-renderer'></div>\n          </div>\n          <IonFooter>\n            <IonButton size=\"small\" onClick={() => { this.prevPage() }}> { '<<' } </IonButton>\n            <IonButton size=\"small\" onClick={() => { this.close() }}>{ 'close' }</IonButton>\n            <IonButton size=\"small\" onClick={() => { this.nextPage() }}> { '>>' } </IonButton>\n          </IonFooter>\n        </IonModal>\n      </IonContent>\n    );\n  }\n};\n\nexport default withIonLifeCycle(BookReader);\n","import { IonButtons, IonContent, IonHeader, IonMenuButton, IonPage, IonTitle, IonToolbar, withIonLifeCycle } from '@ionic/react';\nimport React from 'react';\nimport './MyBooks.css';\nimport { Database, Book } from '../lib/Database';\nimport BookTile from '../components/BookTile';\nimport BookReader from '../components/BookReader';\n\nclass MyBooks extends React.Component<{}, { books: Array<Book>, currentlyReading: Book | null }> {\n  constructor(props: any) {\n    super(props);\n    this.state = {\n      books: new Array<Book>(),\n      currentlyReading: null\n    };\n  }\n\n  async ionViewWillEnter() {\n    let db = new Database();\n    let books = await db.listBooks();\n    this.setState({\n      books\n    });\n  }\n\n  render() {\n    let selectBook = (book: Book) => {\n      this.setState({\n        currentlyReading: book\n      });\n    };\n\n    let closeBook = () => {\n      this.setState({\n        currentlyReading: null\n      });\n    }\n\n    return (\n      <IonPage>\n        <IonHeader>\n          <IonToolbar>\n            <IonButtons slot=\"start\">\n              <IonMenuButton />\n            </IonButtons>\n            <IonTitle>My Books</IonTitle>\n          </IonToolbar>\n        </IonHeader>\n\n        <IonContent>\n          {this.state.books && this.state.books.map(function(book: Book){\n            return <BookTile key={ book.id } book={ book } selectBook={ selectBook } />;\n          })}\n          {this.state.currentlyReading && <BookReader key={ this.state.currentlyReading.id } bookMeta={ this.state.currentlyReading } closeBook={ closeBook } />}\n        </IonContent>\n      </IonPage>\n    );\n  }\n};\n\nexport default withIonLifeCycle(MyBooks);\n","import { IonButtons, IonContent, IonHeader, IonMenuButton, IonPage, IonTitle, IonToolbar } from '@ionic/react';\nimport React from 'react';\nimport './Donate.css';\n\nconst Page: React.FC = () => {\n\n  const name = 'Donate';\n\n  return (\n    <IonPage>\n      <IonHeader>\n        <IonToolbar>\n          <IonButtons slot=\"start\">\n            <IonMenuButton />\n          </IonButtons>\n          <IonTitle>{name}</IonTitle>\n        </IonToolbar>\n      </IonHeader>\n\n      <IonContent>\n        <IonHeader collapse=\"condense\">\n          <IonToolbar>\n            <IonTitle size=\"large\">{name}</IonTitle>\n          </IonToolbar>\n        </IonHeader>\n      </IonContent>\n    </IonPage>\n  );\n};\n\nexport default Page;\n","import Menu from './components/Menu';\nimport Upload from './pages/Upload';\nimport MyBooks from './pages/MyBooks';\nimport Donate from './pages/Donate';\nimport React from 'react';\nimport { IonApp, IonRouterOutlet, IonSplitPane } from '@ionic/react';\nimport { IonReactRouter } from '@ionic/react-router';\nimport { Redirect, Route } from 'react-router-dom';\n\n/* Core CSS required for Ionic components to work properly */\nimport '@ionic/react/css/core.css';\n\n/* Basic CSS for apps built with Ionic */\nimport '@ionic/react/css/normalize.css';\nimport '@ionic/react/css/structure.css';\nimport '@ionic/react/css/typography.css';\n\n/* Optional CSS utils that can be commented out */\nimport '@ionic/react/css/padding.css';\nimport '@ionic/react/css/float-elements.css';\nimport '@ionic/react/css/text-alignment.css';\nimport '@ionic/react/css/text-transformation.css';\nimport '@ionic/react/css/flex-utils.css';\nimport '@ionic/react/css/display.css';\n\n/* Theme variables */\nimport './theme/variables.css';\n\nconst App: React.FC = () => {\n\n  return (\n    <IonApp>\n      <IonReactRouter>\n        <IonSplitPane contentId=\"main\">\n          <Menu />\n          <IonRouterOutlet id=\"main\">\n            <Route path=\"/page/Upload\" component={Upload} exact />\n            <Route path=\"/page/MyBooks\" component={MyBooks} exact />\n            <Route path=\"/page/Donate\" component={Donate} exact />\n            <Redirect from=\"/\" to=\"/page/MyBooks\" exact />\n          </IonRouterOutlet>\n        </IonSplitPane>\n      </IonReactRouter>\n    </IonApp>\n  );\n};\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      if (registration.waiting) {\n        // a new version is already waiting to take control\n        const newWorker = registration.waiting;\n\n        // Makes Workbox call skipWaiting()\n        newWorker.postMessage({ type: 'SKIP_WAITING' });\n      }\n\n      // handler for updates occuring while the app is running, either actively or in the background\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.register();\n"],"sourceRoot":""}